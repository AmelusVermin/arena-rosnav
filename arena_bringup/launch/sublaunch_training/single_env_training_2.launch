<launch>
    <arg name="ns" />
    <arg name="map_file"/>
    <arg name="map_path"/>
    <arg name="show_viz" default="false"/>
    <arg name="use_rviz" default="false"/>
    <arg name="rviz_file" default="nav_train_obstacles"/>

    <!-- Don't change it if you don't know what does it mean! -->
    <arg name="global_frame_id"   value="map"/>
    <arg name="odom_frame_id"     value="$(arg ns)_odom"/>
    <arg name="base_frame_id"     value="$(arg ns)_footprint"/>


    <!-- set map parameters -->
    <!-- <param name="/$(arg ns)/flatland_server/world_path" value="$(find simulator_setup)/maps/$(arg map_file)/map.world.yaml"/> -->
    <param name="/$(arg ns)/flatland_server/world_path" value="$(find simulator_setup)/maps/$(arg map_file)/map.world.yaml" if="$(eval map_file!='random_map')"/>
    <param name="/$(arg ns)/flatland_server/world_path" value="$(find simulator_setup)/maps/$(arg map_file)/$(arg ns)_map.world.yaml" if="$(eval map_file=='random_map')"/>

    <!-- <param name="/$(arg ns)/flatland_server/map_layer_path" value="$(find simulator_setup)/maps/$(arg map_file)/map_layer.yaml"/> -->
    <param name="/$(arg ns)/flatland_server/map_layer_path" value="$(find simulator_setup)/maps/$(arg map_file)/map_layer.yaml" if="$(eval map_file!='random_map')"/>
    <param name="/$(arg ns)/flatland_server/map_layer_path" value="$(find simulator_setup)/maps/$(arg map_file)/$(arg ns)_map_layer.yaml" if="$(eval map_file=='random_map')"/>

    <!-- <param name="/$(arg ns)/flatland_server/map_file" value="$(arg map_file)"/> -->
    <param name="/$(arg ns)/flatland_server/map_file" value="$(arg map_file)" if="$(eval map_file!='random_map')"/>
    <param name="/$(arg ns)/flatland_server/map_file" value="$(arg ns)_$(arg map_file)" if="$(eval map_file=='random_map')"/>
    
    <!-- use fake localization-->
    <include file="$(find arena_bringup)/launch/sublaunch_training/fake_localization.launch">
      <arg name="ns"                value="$(arg ns)"/>
      <arg name="global_frame_id"   value="$(arg global_frame_id)"/>
      <arg name="odom_frame_id"     value="$(arg odom_frame_id)"/>
    </include>
    
    <!-- map server-->
    <node name="map_server" pkg="map_server" type="map_server" args="$(arg map_path)" ns="$(arg ns)">
      <!-- In multi-env training /clock not available, since we only want one map_server, it's clock topic is remapped to /clock -->
      <remap from="/clock" to="/$(arg ns)/clock" />
    </node>

    <include file="$(find arena_bringup)/launch/sublaunch_training/flatland_simulator.launch">
        <arg name="ns" value="$(arg ns)"/>
        <arg name="show_viz"  value="$(arg show_viz)"/>
        <arg name="use_rviz"  value="$(arg use_rviz)"/>
        <arg name="rviz_file" value="$(arg rviz_file)"/>
    </include>

      
    
  </launch>